<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>NetsBlox</title>
    <link rel="shortcut icon" href="favicon.ico">
    <meta property="og:site_name" content="NetsBlox">
    <meta property="og:title" content="NetsBlox">
    <meta property="og:url" content="https://editor.netsblox.org/">
    <script type="text/javascript">
      var SERVER_URL = "https://editor.netsblox.org" || window.location.origin, SERVER_ADDRESS = SERVER_URL.replace(/^.*\/\//, ''), CLIENT_ID = '_netsblox1539656751428';
    </script>
    <script type="text/javascript" src="netsblox-booster.js"></script>
    <script type="text/javascript" src="https://editor.netsblox.org/dist/app.min.js"></script>
    <script type="text/javascript">

      IDE_Morph.prototype.resourceURL = function () {
        let args = Array.prototype.slice.call(arguments, 0);
        let url  = "https://editor.netsblox.org/" + args.join('/');
        return url;
      };

      let SERVER_URL_ORIG = SERVER_URL

      var world;

      window.onload = function () {
        world = new WorldMorph(document.getElementById('world'));
        world.worldCanvas.focus();
        new NetsBloxMorph().openIn(world);
        loop();
      };

      function loop() {
        requestAnimationFrame(loop);
        world.doOneCycle();
      }

      SERVER_URL = "https://crossorigin.me/" + SERVER_URL_ORIG;

      NetCloud.prototype.request = function (url, dict) {
          var resolve,
              reject,
              promise = new Promise(function(res, rej) {
                  resolve = res;
                  reject = rej;
              }),
              data = JSON.stringify(dict);

          url = SERVER_URL_ORIG + url;
          var request = new XMLHttpRequest();

          request.open('POST', url, true);
          request.setRequestHeader(
              'Content-Type',
              'application/json'
          );
          request.withCredentials = true;
          request.onreadystatechange = function () {
              if (request.readyState === 4) {
                  var badStatusCode = request.status > 299 || request.status < 200;
                  if (badStatusCode || request.responseText &&
                          request.responseText.indexOf('ERROR') === 0) {
                      return reject(request);
                  }
                  resolve(JSON.parse(request.responseText));
              }
          };

          request.send(data);
          return promise;
      };

    </script>
    <script type="text/javascript" src="https://editor.netsblox.org/on-message.js"></script>
  </head>
  <body style="margin: 0;">
    <canvas id="world" tabindex="1" style="position: absolute;"></canvas>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-61869323-2', 'auto'); ga('send', 'pageview');
    </script>
  </body>
</html>
